<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plyr YouTube and Local Test</title>
    <!-- Plyr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/plyr@3.7.8/dist/plyr.css">
</head>
<body>
    <h1>Test Plyr with YouTube and Local Videos</h1>

    <!-- Plyr YouTube Video -->
    <h2>YouTube Video</h2>
    <div class="plyr__video-embed" id="youtube-player">
        <iframe
            src="https://www.youtube.com/embed/yYri7s3RCWE?enablejsapi=1&modestbranding=1&rel=0&playsinline=1"
            allowfullscreen
            allow="autoplay; encrypted-media">
        </iframe>
    </div>

    <!-- Plyr Local Video -->
    <h2>Local Video</h2>
    <video id="local-player" class="plyr" playsinline muted controls>
        <source src="static/videos/25%20BEGINNER%20BACHATA%20MOVES%20YOU%20MUST%20KNOW!.mp4" type="video/mp4">
        Your browser does not support HTML5 video.
    </video>

    <!-- Plyr JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/plyr@3.7.8/dist/plyr.polyfilled.js"></script>
    <script>
        // Initialize Plyr for YouTube
        const youtubePlayer = new Plyr('#youtube-player', {
            controls: ['play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen'],
        });

        // Initialize Plyr for Local Video
        const localPlayer = new Plyr('#local-player', {
            controls: ['play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen'],
        });

        // Helper Function to Autoplay and Unmute
        function autoplayAndUnmute(player, playerType, isYouTube = false) {
            console.log(`${playerType} player is ready!`);

            player.muted = true; // Start muted
            player.play();
                // .then(() => {
                //     console.log(`${playerType} autoplay successful.`);
                //     setTimeout(() => {
                //         console.log(`${playerType} attempting to unmute.`);
                //         if (isYouTube) {
                //             player.muted = false;
                //             console.log(`${playerType} unmuted.`);
                //         } else {
                //             player.muted = false;
                //             console.log(`${playerType} unmuted.`);
                //         }
                //     }, 5000); // Wait 5 seconds before unmuting
                // })
                // .catch((error) => {
                //     console.error(`${playerType} autoplay failed:`, error);
                // });

            // Add playback state listeners
            player.on('play', () => console.log(`${playerType} video is playing!`));
            player.on('pause', () => console.log(`${playerType} video is paused!`));
            player.on('ended', () => console.log(`${playerType} video has ended.`));
        }

        // Autoplay YouTube Video
        youtubePlayer.on('ready', () => autoplayAndUnmute(youtubePlayer, 'YouTube', true));

        // Autoplay Local Video
        localPlayer.on('ready', () => autoplayAndUnmute(localPlayer, 'Local'));
    </script>
</body>
</html>
